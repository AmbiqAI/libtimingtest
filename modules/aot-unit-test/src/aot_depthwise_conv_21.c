/******************************************************************************
 * @file        aot_depthwise_conv_21.c
 * @brief       Autogenerated AOT DEPTHWISE_CONV_2D kernel
 * @details     This file was generated by HeliosAOT v0.2.2 on 2025-06-04.
 *   This kernel represents node #21 in the corresponding graph.
 *
 * @date        2025-06-04
 *
 * @copyright
 *   © 2025 Ambiq. All rights reserved.
 *
 *   This generated C module is licensed for use **only** on Ambiq hardware
 *   incorporating Ambiq’s sub-threshold power optimized technology.
 *   Any other use is strictly prohibited.
 *
 *   See “LICENSE.txt” at the root of this distribution for full terms.
 *
 * @note        Do not edit this file—any changes will be overwritten.
 ******************************************************************************/

#include <stdalign.h>
#include "ns_ambiqsuite_harness.h"
#include "arm_nnfunctions.h"
#include "arm_nnsupportfunctions.h"
#include "aot_depthwise_conv_21.h"

#if defined(ARM_MATH_MVEI)
#define SCRATCH_BUFFER_SIZE 4464
#elif defined(ARM_MATH_DSP)
#define SCRATCH_BUFFER_SIZE 0
#else
#define SCRATCH_BUFFER_SIZE 0
#endif

#define HAS_BIAS 1

// Input dimensions: input shape is [1, H_IN, W_IN, C_IN]
static const cmsis_nn_dims dw_21_input_dims = { .n = 1, .h = 6, .w = 6, .c = 128 };

// Filter dimensions: weights shape is [1, H_FILT, W_FILT, C_OUT].
static const cmsis_nn_dims dw_21_filter_dims = { .n = 1, .h = 3, .w = 3, .c = 128 };

// Bias dimensions: bias shape is [1, 1, 1, C_OUT].
static const cmsis_nn_dims dw_21_bias_dims = { .n = 1, .h = 1, .w = 1, .c = 128 };

// Output dimensions: output shape is [1, H_OUT, W_OUT, C_OUT].
static const cmsis_nn_dims dw_21_output_dims = { .n = 1, .h = 6, .w = 6, .c = 128 };

// Quantization parameters (per-channel quantization)
static const int32_t dw_21_multiplier[128] = {
  1766807392, 1261167431, 1657994912, 1683603221, 1230693259, 1803315414, 1317830673, 1494626820, 1329015918, 2032637527, 1282794017, 1317348415, 2060475297, 1204089238, 1143066489, 1724017507, 1298617205, 1268361679, 1323114296, 1931784838, 
  1349355218, 1743438521, 2074278536, 1270603646, 1278923866, 1218299276, 1322211748, 2119141627, 1901634982, 1995157261, 1185270203, 1268590161, 1691962084, 1286053758, 1352950516, 1708676437, 1215228674, 1576956266, 1192359625, 1557219507, 
  1652330344, 1464217708, 1818566832, 1677854904, 1278955202, 1267651079, 1854771616, 1464240613, 1606830987, 1084547353, 1658331312, 1207045177, 1362686316, 1892280407, 1655522916, 1289763858, 1479704495, 1545666386, 1445484671, 1387081813, 
  1771245236, 1489549618, 1493894580, 1284537286, 1884813273, 1614094652, 1873950938, 1376849984, 1227168642, 1542691336, 1816838459, 1152172487, 1218847157, 1376464121, 1668944929, 1338562300, 1463360547, 1536601279, 1576626751, 1391291316, 
  1367863286, 1802160635, 2106513401, 1362357644, 1832269320, 1579546858, 1093807640, 1270543223, 2073887053, 1267952350, 1350264793, 1940305297, 1288646739, 1110823756, 1824378804, 1644659879, 1890082985, 1478725364, 1476638529, 1969653918, 
  1357154117, 1315262002, 1236256232, 1194253669, 1558012170, 1081293725, 1910943888, 1882552055, 1165298147, 1192616492, 1471419544, 1122584634, 1599295701, 1237678275, 1152410384, 1285000855, 1175671338, 1881482571, 1499837374, 1169848898, 
  2026176362, 1810436593, 1608835338, 1118328198, 1314943587, 1154411995, 1272563874, 1787351849
};
static const int32_t dw_21_shift[128] = {
  -5, -5, -6, -6, -5, -8, -14, -5, -9, -5, -6, -6, -6, -5, -6, -5, -8, -4, -5, -5, 
  -5, -11, -6, -5, -5, -9, -6, -6, -6, -6, -5, -9, -5, -5, -5, -5, -6, -5, -5, -5, 
  -6, -7, -5, -5, -5, -5, -6, -5, -5, -4, -5, -5, -5, -7, -5, -5, -5, -5, -5, -5, 
  -8, -4, -7, -20, -7, -8, -5, -5, -5, -8, -9, -9, -5, -8, -5, -5, -5, -5, -7, -5, 
  -5, -8, -6, -5, -6, -5, -5, -9, -22, -5, -9, -5, -19, -4, -5, -6, -5, -5, -5, -5, 
  -11, -5, -5, -5, -5, -4, -9, -5, -7, -6, -5, -4, -5, -7, -10, -5, -5, -5, -7, -5, 
  -6, -5, -6, -5, -11, -5, -5, -5
};

// Offsets and activation parameters.
static const int32_t dw_21_input_zero_point = -128;
static const int32_t dw_21_output_zero_point = -128;


// Weight and bias data.
alignas(16) static NS_PUT_IN_TCM int8_t dw_21_weights[] = {
  -3, -36, -106, 9, -98, -80, -127, 19, -77, -41, 58, -46, -2, -29, 0, -9, -23, -5, -31, -10, 
  -39, -123, 16, 0, -23, -115, -49, -16, -36, -3, -1, -30, -4, 2, -75, 8, -15, -6, -101, -90, 
  -127, 3, -4, -53, -38, 24, 5, -78, 17, -8, -22, -127, -127, -35, -127, -127, -127, -127, 14, 14, 
  -101, -102, -6, -21, 127, -76, -127, -6, -25, -127, 17, -124, -47, -127, 5, -19, 15, -23, -13, 17, 
  -8, -100, -25, 4, -26, -52, -29, -37, 60, 8, 66, -7, -6, -127, -57, -127, 20, -85, -20, 39, 
  -93, -42, -127, 19, -127, 0, -63, -9, -26, 5, -10, -47, 20, -28, -52, -93, -24, -18, 25, -9, 
  -85, -127, 11, -43, -5, 25, -57, 1, 25, 48, -123, 19, -44, -30, 77, -72, -60, -59, -51, 84, 
  22, 16, 23, -45, 21, -12, -29, 5, 21, -27, -1, -12, -127, -93, -96, -32, -31, -33, -39, 35, 
  10, -38, -127, -6, 10, 5, 14, -127, -87, -41, -127, -40, -127, -28, -19, -87, -61, -8, 12, -43, 
  -49, 23, -81, -62, -105, 25, 6, -127, -89, -127, 44, 8, 80, -35, -90, 36, 9, -75, -72, -105, 
  22, -27, -5, 15, -16, -127, 127, -25, 3, -43, -29, -122, 35, 0, -11, 108, -77, -6, -36, 10, 
  -68, -21, -76, 25, -66, -13, 9, -12, -52, -127, -36, -27, -87, 13, -6, -72, 84, -105, -75, -127, 
  -34, -102, 127, 4, 32, -72, 127, -17, -13, -38, -78, -1, 127, -57, -7, 4, -32, -55, 70, -37, 
  -127, -3, 110, -127, -127, 9, -127, -127, -21, -4, 13, -127, -15, -2, 33, -88, -2, 82, -52, -47, 
  3, -127, -94, -65, 46, 18, -66, 52, -127, 24, -91, -31, -46, 12, -1, -27, 20, -115, -85, -127, 
  -64, -61, -93, -72, -127, 18, 3, 4, 10, 46, -23, -65, 21, -17, -23, 12, -127, -91, 23, 39, 
  15, 62, -88, -41, -55, -77, -127, -49, 8, -4, 2, -1, -84, -110, 28, 14, 5, -35, 23, -11, 
  -73, 14, 44, 55, -37, 13, -127, 6, 71, -13, -127, -54, -127, 4, 7, -61, -99, -114, 12, 5, 
  -2, -9, 29, -127, 33, -127, 4, -18, -8, -127, 38, -13, -43, -40, 39, -15, 18, -44, 48, 1, 
  -24, -123, 13, -6, 9, 29, -17, 11, -32, 12, -37, 10, -6, -6, 43, -9, -90, -1, 21, 16, 
  106, 5, -71, -11, 1, -80, -25, 2, -47, -45, -55, -49, 12, -105, -99, -9, -3, 7, -23, -39, 
  49, -127, -127, 3, -119, -36, -28, -10, -11, -29, -21, 23, -9, 31, 6, -93, -43, 21, -58, -37, 
  3, -107, -57, 26, 11, -32, 19, -3, -44, 122, -18, 4, 17, 15, 50, -23, -46, -46, -55, -24, 
  1, 23, 31, -3, 4, -29, 0, -127, -18, -96, 26, 19, -7, -83, 79, -87, -127, -98, -40, -97, 
  -17, -100, 0, -56, -13, 3, -28, -11, -35, -13, 25, 23, 33, 35, -127, 1, -53, 5, -13, -118, 
  -93, 20, -9, -33, -89, -25, -127, -127, -9, 10, -127, -6, -23, -51, 30, -54, 0, 39, 90, -27, 
  59, -54, -21, -88, -35, -35, 127, -7, 127, -85, -127, 24, -20, 50, -64, 23, -47, 6, -106, -69, 
  -127, -15, 19, -22, -25, 7, -45, -9, -127, -72, 1, -32, 36, 66, -24, 8, 4, -55, -21, -35, 
  -16, -75, -31, -52, -63, 127, -44, -1, -45, -15, -61, -47, 5, -4, 127, 127, 24, 74, 17, -45, 
  -34, 48, -54, 5, -75, 28, -127, 34, 18, -17, 32, 5, -67, 50, -127, -86, -19, -43, -100, 127, 
  -127, -127, -54, -27, -100, 0, -66, -17, -8, -20, -127, -127, 64, -34, 5, -119, -1, -29, 49, 0, 
  127, -100, -67, -19, -78, 5, 42, 13, -127, -64, -38, 7, 19, 1, -32, 29, 105, -74, 1, -21, 
  -127, -29, -117, 33, -70, 59, 54, -95, -76, 52, -48, -80, 46, -63, 8, -85, 44, 9, -20, -127, 
  14, 127, -127, -38, -2, -47, -127, -104, -66, -4, 34, 53, -86, -127, 9, 4, -7, -21, -44, -51, 
  6, -127, 27, -46, -41, -127, -127, -127, 6, -92, -127, 8, -12, 21, 41, 18, -17, 21, -127, 14, 
  19, 31, 7, 35, 60, 127, -9, -127, 1, 18, -76, -12, -127, 21, -17, -26, -46, -42, -13, -14, 
  -127, 81, 5, -31, -84, -6, 30, 16, -24, -46, -50, -36, 33, 27, -70, -72, -27, 8, -56, -103, 
  14, -15, 15, 15, -32, -46, 36, -3, 21, 41, -44, -9, -127, -2, -46, 10, -23, -127, -33, 16, 
  -26, 8, -37, -33, 32, -127, -11, 24, -14, -37, -10, -127, 35, 54, -22, -17, 86, -115, 1, 15, 
  -16, -7, 1, -9, 93, 11, -16, 12, -49, -91, 12, -15, 9, -34, 0, -21, -6, -92, -127, -26, 
  3, -28, 4, -127, 13, -102, 20, 17, -27, -42, 8, 17, -12, 21, -4, -9, -26, -15, 1, -37, 
  -22, 8, -93, -10, 11, -90, -48, -60, 65, 14, 5, 3, -39, 97, 25, -5, -22, -41, -2, -4, 
  -22, -1, 5, -15, -127, -17, -14, -62, 8, 51, 7, -61, -6, -127, 30, 2, 7, 36, -1, -127, 
  -32, -107, 32, -78, 6, -127, 2, 23, 88, -49, -40, -127, 18, -54, 44, -2, -7, 5, 2, -26, 
  9, -1, -34, -127, -22, -70, 15, -127, -127, -9, -24, 0, 9, -6, -19, 14, 22, -47, -14, -40, 
  0, 127, 1, 11, 104, -127, -37, -60, -127, 41, 11, 9, 104, -127, -11, -59, -83, -21, -17, -127, 
  -116, 95, 74, -1, -39, -127, -4, -1, -23, 19, 22, -76, -29, -39, -36, -8, 37, -17, -20, 9, 
  -9, -54, 16, 26, 25, -127, -11, -12, -61, 21, -57, -7, -19, 13, 37, -14, -23, 0, 3, 24, 
  -7, -40, -32, -77, 2, 6, -5, 127, -123, 11, -70, -35, 2, 10, -23, -127, -15, 127, -98, 30, 
  -127, -40, -127, -4, 6, -56, -110, -12, -20, -6, -41, 5, 1, -20, -106, -28, 127, 18, 24, -66, 
  -35, -127, 127, 5, -1, -86, -27, -5, -8, -4, -7, -17, -29, -12, 7, -70, -64, 14, -11, -30, 
  10, 32, -22, -71, -39, -127, -127, -2, -57, 39, 16, 28, 11, -25, -49, -125, -101, -127, -6, -75, 
  6, -26, -32, -89, -127, -2, -91, -96, -15, -24, -46, -127, -44, -59, -23, 127, 28, -119, -14, 7, 
  -127, 24, -75, -23, -68, -111, 26, 0, -39, -31, -105, -5, -13, -17, -14, 32, 6, -1, 22, -17, 
  19, -33, -7, -11, -56, -48, 7, -34, 43, 111, 5, -40, -127, -90, -22, 43, -111, -16, 14, -127, 
  4, -2, -36, 1, -50, 82, -38, 11, -126, -24, -76, 4, 19, -44, -68, 0, 3, -26, -6, 62, 
  8, -12, -12, -52, -53, 13, -43, -25, 7, -11, 14, -2, -1, 17, 28, 14, 0, -17, -24, -1, 
  15, -8, -6, -16, -4, -19, -45, 21, -2, -1, -52, -127
};

#if HAS_BIAS
alignas(16) static NS_PUT_IN_TCM int32_t dw_21_bias[] = {
  -333, -573, -976, -798, -524, -4097, 548517, -453, -5986, -388, -607, -1075, -735, -505, -676, -419, -13521, -213, -572, -279, 
  -534, -3668, 185, -473, -473, -1309, 184, 102, -707, -663, -616, -10352, -332, -515, -459, -379, -990, -402, -605, -465, 
  -868, 33, -417, -481, -450, -477, -658, -422, -315, -330, -442, -633, -449, -3244, -502, -20, -491, -420, -495, -660, 
  4555, -243, -1452, 10094204, -4898, -12811, -18, -532, -466, 3037, -3567, -6308, -654, -688, -333, -517, -504, -411, -21, -474, 
  -401, -4727, -471, -481, -602, -356, -643, 9032, 99174816, -544, -5471, -302, 5214247, -360, -471, -883, -286, -421, -394, -379, 
  -13693, -295, -337, -612, -364, -316, -16745, -271, -3102, -490, -458, -260, -462, -1244, -4096, -588, -577, -439, -2273, -643, 
  -621, -376, -768, -491, -8683, -589, -512, -296
};
#else
static NS_PUT_IN_TCM int32_t *dw_21_bias = NULL;
#endif

alignas(16) static NS_PUT_IN_TCM int8_t dw_21_scratch_buffer[SCRATCH_BUFFER_SIZE];

static cmsis_nn_context dw_21_context = {
    .buf = dw_21_scratch_buffer,
    .size = sizeof(dw_21_scratch_buffer),
};


int32_t aot_depthwise_conv_21_init(void)
{
    return 0;
}

const cmsis_nn_per_channel_quant_params dw_21_quant_params = {
    .multiplier = (int32_t*)dw_21_multiplier,
    .shift = (int32_t*)dw_21_shift,
};

const cmsis_nn_dw_conv_params dw_21_dw_conv_params = {
    .input_offset = -dw_21_input_zero_point,
    .output_offset = dw_21_output_zero_point,
    .ch_mult = 1,
    .stride.w = 1,
    .stride.h = 1,
    .padding.w = 1,
    .padding.h = 1,
    .dilation.w = 1,
    .dilation.h = 1,
    .activation.min = -128,
    .activation.max = 127,
};

int32_t aot_depthwise_conv_21_run(const int8_t* __restrict input, int8_t* __restrict output)
{

    return arm_depthwise_conv_wrapper_s8(
        &dw_21_context,
        &dw_21_dw_conv_params,
        &dw_21_quant_params,
        &dw_21_input_dims,
        input,
        &dw_21_filter_dims,
        dw_21_weights,
        &dw_21_bias_dims,
        dw_21_bias,
        &dw_21_output_dims,
        output
    );

}
