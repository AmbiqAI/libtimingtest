/******************************************************************************
 * @file        aot_depthwise_conv_23.c
 * @brief       Autogenerated AOT DEPTHWISE_CONV_2D kernel
 * @details     This file was generated by HeliosAOT v0.2.2 on 2025-06-04.
 *   This kernel represents node #23 in the corresponding graph.
 *
 * @date        2025-06-04
 *
 * @copyright
 *   © 2025 Ambiq. All rights reserved.
 *
 *   This generated C module is licensed for use **only** on Ambiq hardware
 *   incorporating Ambiq’s sub-threshold power optimized technology.
 *   Any other use is strictly prohibited.
 *
 *   See “LICENSE.txt” at the root of this distribution for full terms.
 *
 * @note        Do not edit this file—any changes will be overwritten.
 ******************************************************************************/

#include <stdalign.h>
#include "ns_ambiqsuite_harness.h"
#include "arm_nnfunctions.h"
#include "arm_nnsupportfunctions.h"
#include "aot_depthwise_conv_23.h"

#if defined(ARM_MATH_MVEI)
#define SCRATCH_BUFFER_SIZE 4464
#elif defined(ARM_MATH_DSP)
#define SCRATCH_BUFFER_SIZE 0
#else
#define SCRATCH_BUFFER_SIZE 0
#endif

#define HAS_BIAS 1

// Input dimensions: input shape is [1, H_IN, W_IN, C_IN]
static const cmsis_nn_dims dw_23_input_dims = { .n = 1, .h = 6, .w = 6, .c = 128 };

// Filter dimensions: weights shape is [1, H_FILT, W_FILT, C_OUT].
static const cmsis_nn_dims dw_23_filter_dims = { .n = 1, .h = 3, .w = 3, .c = 128 };

// Bias dimensions: bias shape is [1, 1, 1, C_OUT].
static const cmsis_nn_dims dw_23_bias_dims = { .n = 1, .h = 1, .w = 1, .c = 128 };

// Output dimensions: output shape is [1, H_OUT, W_OUT, C_OUT].
static const cmsis_nn_dims dw_23_output_dims = { .n = 1, .h = 3, .w = 3, .c = 128 };

// Quantization parameters (per-channel quantization)
static const int32_t dw_23_multiplier[128] = {
  1418144952, 1451064627, 1729870503, 1312105996, 1080617039, 1097392361, 1827606788, 1975655843, 1226137063, 2116528314, 1245790839, 1578051225, 1626554554, 2024465765, 1190396868, 1819251440, 1880227370, 1673454364, 1605940847, 1807495178, 
  1082834986, 1836306873, 1510895925, 1604661513, 1099385740, 1635404924, 1105365590, 1597996967, 1861828168, 1486417829, 1252806910, 1359192898, 1577691096, 1580502629, 2011468600, 1601086317, 1431004643, 1185394347, 1431506931, 1094156167, 
  1276862066, 1950746396, 1620298798, 1155542226, 1829627222, 1778787115, 1722679386, 1966025368, 1226821663, 1263763469, 1360429594, 1282098331, 1315314179, 1642327784, 2138065910, 1328631129, 1635069746, 1147352555, 1973776708, 2024293683, 
  1538859160, 1236626037, 1118988178, 1720226452, 1852131154, 1484486973, 1622234339, 1876765844, 1960030221, 1322123178, 2060130913, 1406567560, 1212689808, 1818500398, 1285703354, 1992816820, 1727108012, 1822886004, 1416653861, 1859652095, 
  1614847239, 1678930588, 1206737491, 1186001701, 1580162958, 1546006969, 1277428312, 1379981842, 1156688005, 1255483550, 2058948519, 2056939939, 2054323527, 1909058185, 1323622586, 1207130411, 1244623645, 1941314197, 1320047678, 1153422462, 
  1611473475, 1136682417, 1568719790, 1933927671, 1472853368, 1334601707, 1299592573, 2031073906, 1565063334, 1248209547, 1928035583, 1922354581, 1552124677, 1936485575, 2050289733, 1246014928, 1110175283, 1988910749, 2043651764, 1427048285, 
  1813027042, 1551566653, 1283676228, 1703493769, 2024709165, 1099838602, 1305648618, 2077581752
};
static const int32_t dw_23_shift[128] = {
  -5, -8, -11, -4, -5, -4, -15, -5, -8, -16, -18, -5, -5, -5, -8, -8, -6, -8, -5, -5, 
  -4, -4, -11, -5, -5, -5, -4, -10, -7, -4, -4, -5, -11, -5, -6, -7, -7, -4, -4, -10, 
  -4, -7, -5, -7, -5, -5, -5, -5, -5, -13, -5, -11, -7, -5, -20, -5, -5, -5, -5, -19, 
  -5, -9, -4, -5, -5, -14, -5, -5, -5, -7, -5, -6, -10, -5, -6, -5, -8, -7, -6, -5, 
  -5, -5, -5, -4, -5, -12, -5, -7, -4, -4, -6, -9, -8, -5, -4, -4, -5, -16, -5, -5, 
  -5, -7, -5, -5, -4, -5, -7, -5, -20, -14, -5, -13, -9, -5, -5, -7, -4, -5, -8, -4, 
  -5, -7, -22, -14, -5, -4, -6, -11
};

// Offsets and activation parameters.
static const int32_t dw_23_input_zero_point = -128;
static const int32_t dw_23_output_zero_point = -128;


// Weight and bias data.
alignas(16) static NS_PUT_IN_TCM int8_t dw_23_weights[] = {
  15, -102, -11, -12, 15, -2, 48, 8, -23, 114, -9, 8, 8, 11, -29, 2, -46, -9, 4, 5, 
  13, 0, -6, 16, -106, 36, -4, -6, -66, 9, -18, -127, -37, -47, -40, 17, 19, -42, 8, -12, 
  12, -127, 40, -27, -17, -14, 27, 15, -127, -127, -13, -65, -85, -23, -52, 18, 17, -127, 22, -15, 
  -11, -39, -127, -4, -88, 44, 12, -21, -1, -89, 8, -92, -62, 20, 9, 16, -45, 12, 3, 5, 
  -19, 1, -57, -9, -115, -58, -40, 31, 14, -53, 4, -44, 9, -99, -3, 13, 23, 64, 7, -30, 
  11, 36, 31, -56, -12, -127, 22, 20, 127, 74, 28, 17, 28, 23, -127, -85, -9, -27, 20, 18, 
  -127, 41, 73, 3, -65, -8, -85, -80, -36, -4, 120, 21, -25, -18, 120, -26, 44, 92, 127, -30, 
  -7, -38, 4, 127, 33, 93, -8, -45, -38, 7, -54, -24, -24, -28, -127, 0, 127, -64, -19, -10, 
  49, -28, -102, 127, 127, -22, -17, -91, -5, 64, -17, 9, -36, 27, -68, -32, -29, 22, -85, 1, 
  -27, 31, 65, -127, -31, -69, -17, -82, -127, 87, 18, 31, -46, -36, 23, -8, -13, -28, 0, -68, 
  -3, -28, 61, -59, 19, 127, -3, -20, 40, -5, -127, 6, -127, 68, 25, 127, -9, -127, -43, 56, 
  127, -49, 8, -45, -18, 102, 4, 14, 9, 127, -40, 33, -6, -91, 127, -38, 95, 40, -27, 71, 
  127, -25, 5, -127, 0, -127, 127, -24, -23, 127, -106, -127, -81, 11, -104, 64, -39, -77, 127, -13, 
  -11, 17, 77, -127, 19, -55, -2, 3, -77, -9, -21, -11, -25, 18, -127, -31, -117, -72, -87, -12, 
  14, -108, 27, -37, -84, 14, -80, -83, -16, 0, -8, 17, 12, -2, -12, -86, 9, 53, 14, 41, 
  15, -13, -16, -6, -34, 115, -5, 127, 52, -12, 83, -105, -6, -122, 10, -31, -26, 127, 15, -6, 
  18, -57, -28, 23, -127, 31, -10, -15, 12, -127, 1, -127, 127, 23, -1, 11, -27, -47, 8, -30, 
  -30, 68, -114, 14, -43, -69, -23, 127, 15, -53, -22, -127, -10, 35, 34, -8, -127, 27, 28, -11, 
  -23, -75, 9, 17, 9, 17, -4, 10, 11, -90, -23, -91, 6, -126, 21, -24, -6, 32, -127, -27, 
  -127, 18, -127, 105, -14, -79, 113, -20, 13, 19, 127, -25, -9, 119, 83, -127, -26, -35, 28, 25, 
  -52, 78, 2, -37, -8, -5, -27, -45, -120, -98, -13, 44, 8, -43, 42, -122, 127, -38, 28, 66, 
  55, -61, 14, 26, 31, -124, 8, 75, 59, 8, 2, -28, -12, -33, -59, 17, 61, -62, 93, -126, 
  -4, 9, -47, 1, -90, 13, -79, 17, -127, -29, 36, 8, -8, 62, -50, 80, 69, -30, 127, 10, 
  2, 69, -4, -33, 23, 22, 35, 6, -91, 85, -1, 66, 5, -47, -6, 77, 78, 55, 27, 13, 
  -104, 127, -127, -78, -6, 77, 5, -65, -72, -25, 45, 0, -69, 127, -14, 57, 77, 8, -108, 9, 
  -25, 24, 76, -57, -46, 51, -49, -51, 11, -68, -5, 58, -106, 35, 114, -17, -65, -23, 67, -27, 
  127, 127, 80, 12, 21, -101, 127, 113, -61, 127, -23, -66, -8, -9, -77, -68, 22, -17, -29, 69, 
  41, -127, -26, 66, 97, -18, -127, 83, 75, -27, -9, 127, -26, 14, -126, 127, -17, -50, -64, -24, 
  -14, 44, -127, 37, 99, 11, 127, -2, -18, 40, -21, -127, -51, 1, 44, -4, -32, -69, -49, -119, 
  -16, 127, -29, -87, 125, 1, 9, -39, -9, 82, -4, -92, -53, -24, 10, 0, -59, 127, 8, 99, 
  -14, -17, -115, 56, 97, -36, -29, 26, -28, 111, -87, -83, 16, 118, -33, -56, -56, -19, 62, 29, 
  -114, 113, -30, 127, 80, -8, -44, 27, -42, -8, 108, -127, 35, 105, -78, -111, -63, -23, 26, 49, 
  -12, -127, 96, 26, -127, -20, 48, -16, 37, -84, -11, -84, 12, 9, 31, 51, -117, -25, -76, -127, 
  -127, -127, -127, 14, -103, -106, 52, 127, 18, -24, -90, -72, 52, -96, -81, -10, -30, -58, -72, 120, 
  -25, 42, -127, 109, -100, 12, 15, -127, -3, 84, -41, 47, 101, 32, 62, -19, 13, -34, 34, -38, 
  -36, -21, -10, -68, -26, -127, -85, 3, -19, 49, 12, -127, 127, -45, 14, -23, 23, -18, 3, 16, 
  2, -58, -8, -127, 10, 123, -87, -7, -118, 19, -127, 8, 4, -127, -66, -47, 54, 6, -50, -26, 
  -82, -31, 13, -29, -3, -21, -21, -22, -86, -24, -5, -12, -14, -127, -19, 33, -59, -32, -2, -6, 
  -6, -18, -28, -34, -49, -14, 24, 34, -69, -78, 56, -127, -33, -127, 3, -97, -16, -33, 6, -112, 
  -22, 24, -9, 21, -127, 26, -14, 23, 4, -15, 16, -69, -127, -127, -122, -60, -56, 11, -17, -103, 
  79, -76, -59, 6, -6, -36, -25, -48, -59, -117, -43, 31, -26, -104, -127, 0, -31, -32, 48, 51, 
  72, -127, -1, -70, -127, 1, -127, -12, -58, 43, -70, -66, -62, 4, -80, -22, -17, 27, -127, -3, 
  0, -12, 105, -28, 49, 2, -127, -35, 17, -33, -13, 9, -15, 34, 22, -2, -36, -14, -32, 46, 
  21, -77, -7, -16, -127, 4, -7, 34, -29, 4, -114, -127, -127, 42, -17, -35, -26, 34, -44, -1, 
  -15, -20, -102, -22, -25, -27, 29, -23, 20, -22, 51, -2, 18, -127, -4, 63, -127, 81, 66, -90, 
  -44, -58, 33, 14, 27, 25, 19, -54, 11, -127, 55, 84, -47, 56, 29, -14, 13, 1, -14, -72, 
  85, -58, 19, 79, -64, 16, -40, 66, 12, -127, -112, 2, 1, -100, -45, 99, -114, -114, -99, 23, 
  -80, -127, -122, -47, -104, -6, -96, 57, 127, -66, 61, -21, -73, -38, -42, -2, 33, 72, -15, -71, 
  -3, -28, -127, -127, 11, 61, -27, 59, 47, -66, -3, 23, 81, 3, -44, -127, -127, -34, 14, -56, 
  49, 8, -127, 10, 4, -9, -63, 91, 1, -68, -15, 8, -106, 27, -102, -127, -89, -2, -127, -114, 
  -18, -20, 13, -127, -63, 21, -6, 37, 8, 34, 4, -12, -127, 9, 9, 4, 20, 18, -62, -30, 
  9, -89, -13, 50, 10, -32, 100, -57, -102, -38, -38, -14, 17, 39, 0, -36, -127, -5, 1, 5, 
  15, -42, -30, -4, -54, -103, -50, -127, -99, -106, -8, 96, 91, 0, -127, -39, 11, 45, -87, -20, 
  -13, -127, -127, 49, -127, 29, -39, -2, -127, -34, -10, -12, -49, 2, -62, 39, 87, -49, 87, 56, 
  -10, 66, -33, 14, 48, 63, -79, -127, 5, -38, -115, -14, -3, 2, 3, -67, 54, 15, -38, -57, 
  40, -16, -31, -27, -95, -127, -33, -104, 14, 35, -32, -10, -127, 17, 33, 23, 1, -52, -127, -4, 
  -40, -28, -43, -107, -36, -14, -123, -61, 21, -20, -10, -99, 24, -21, -127, -21, 18, -89, 33, 47, 
  34, 21, -29, -6, -76, -18, -24, -16, -28, 12, 3, 127
};

#if HAS_BIAS
alignas(16) static NS_PUT_IN_TCM int32_t dw_23_bias[] = {
  -583, 2088, -21297, -280, -721, -385, 567343, -277, -4410, 617536, 10441783, -593, -25, -336, -5212, -7027, -1064, -6742, -113, -416, 
  -348, -205, 4635, -544, -856, -576, -621, -13022, -1089, -342, -288, -305, -13857, -567, -857, -907, 3794, -282, -212, -5558, 
  -338, -1506, -513, -9218, -405, -348, -470, -492, -88, 129185, -592, -21518, -7538, -267, -756550, -732, -450, -741, -460, 2360003, 
  -584, -28982, 499, -524, -383, -18268, -573, -433, -17, -3907, -334, -1121, -13101, -433, -5495, -460, -8249, -436, 42, -386, 
  -477, -393, -1012, -257, -736, -20038, -630, -848, -276, 590, -787, -14395, -1161, -450, -36, -387, -694, 818029, -656, -615, 
  -536, -809, -410, -474, -316, -792, 2938, -327, 26571660, 323185, -126, 138326, 11436, -508, -439, 914, -323, -369, -946, -245, 
  -149, 1601, -1312962, 404778, -42, -494, 251, -65883
};
#else
static NS_PUT_IN_TCM int32_t *dw_23_bias = NULL;
#endif

alignas(16) static NS_PUT_IN_TCM int8_t dw_23_scratch_buffer[SCRATCH_BUFFER_SIZE];

static cmsis_nn_context dw_23_context = {
    .buf = dw_23_scratch_buffer,
    .size = sizeof(dw_23_scratch_buffer),
};


int32_t aot_depthwise_conv_23_init(void)
{
    return 0;
}

const cmsis_nn_per_channel_quant_params dw_23_quant_params = {
    .multiplier = (int32_t*)dw_23_multiplier,
    .shift = (int32_t*)dw_23_shift,
};

const cmsis_nn_dw_conv_params dw_23_dw_conv_params = {
    .input_offset = -dw_23_input_zero_point,
    .output_offset = dw_23_output_zero_point,
    .ch_mult = 1,
    .stride.w = 2,
    .stride.h = 2,
    .padding.w = 0,
    .padding.h = 0,
    .dilation.w = 1,
    .dilation.h = 1,
    .activation.min = -128,
    .activation.max = 127,
};

int32_t aot_depthwise_conv_23_run(const int8_t* __restrict input, int8_t* __restrict output)
{

    return arm_depthwise_conv_wrapper_s8(
        &dw_23_context,
        &dw_23_dw_conv_params,
        &dw_23_quant_params,
        &dw_23_input_dims,
        input,
        &dw_23_filter_dims,
        dw_23_weights,
        &dw_23_bias_dims,
        dw_23_bias,
        &dw_23_output_dims,
        output
    );

}
