/******************************************************************************
 * @file        aot_conv_8.c
 * @brief       Autogenerated AOT CONV_2D kernel
 * @details     This file was generated by HeliosAOT v0.2.2 on 2025-06-04.
 *   This kernel represents node #8 in the corresponding graph.
 *
 * @date        2025-06-04
 *
 * @copyright
 *   © 2025 Ambiq. All rights reserved.
 *
 *   This generated C module is licensed for use **only** on Ambiq hardware
 *   incorporating Ambiq’s sub-threshold power optimized technology.
 *   Any other use is strictly prohibited.
 *
 *   See “LICENSE.txt” at the root of this distribution for full terms.
 *
 * @note        Do not edit this file—any changes will be overwritten.
 ******************************************************************************/

#include <stdalign.h>
#include "ns_ambiqsuite_harness.h"
#include "arm_nnfunctions.h"
#include "arm_nnsupportfunctions.h"
#include "aot_conv_8.h"

#if defined(ARM_MATH_MVEI)
#define SCRATCH_BUFFER_SIZE 0
#elif defined(ARM_MATH_DSP)
#define SCRATCH_BUFFER_SIZE 128
#else
#define SCRATCH_BUFFER_SIZE 0
#endif

#define HAS_BIAS 1

// Input dimensions: input shape is [1, H_IN, W_IN, C_IN]
static const cmsis_nn_dims conv_8_input_dims = { .n = 1, .h = 12, .w = 12, .c = 32 };

// Filter dimensions: weights shape is [C_OUT, H_FILT, W_FILT, C_IN].
static const cmsis_nn_dims conv_8_filter_dims = { .n =  64, .h = 1, .w = 1, .c = 32 };

// Bias dimensions: bias shape is [1, 1, 1, C_OUT].
static const cmsis_nn_dims conv_8_bias_dims = { .n = 1, .h = 1, .w = 1, .c = 64 };

// Output dimensions: output shape is [1, H_OUT, W_OUT, C_OUT].
static const cmsis_nn_dims conv_8_output_dims = { .n = 1, .h = 12, .w = 12, .c = 64 };

// Quantization parameters (per-channel quantization)
static const int32_t conv_8_multiplier[64] = {
  1955282432, 1579959424, 1447996672, 2084237568, 1275775104, 2081543296, 1450957440, 1423214208, 1759248128, 1100988160, 1700873856, 1845333888, 1230061056, 1108089984, 1313990912, 1316854656, 2005354752, 1806449280, 1866325376, 1075289856, 
  1457337472, 1134073088, 2134325248, 1619078016, 1492693888, 1752887552, 1296785152, 1180198144, 1143809280, 1897205376, 1650090624, 1080487168, 1319073920, 1788367232, 1449633792, 1078924416, 1598513280, 1143818880, 1437660800, 1717375616, 
  1626915456, 1361284352, 1299651200, 2080328704, 1643345152, 1099368576, 1550248448, 1407080704, 1257617024, 1655353984, 2036523520, 1203902080, 1786195712, 1815191424, 1538112768, 1693517568, 1490275584, 1100166272, 1371141248, 1765232128, 
  1750458240, 1893754880, 1842939392, 2128243712
};
static const int32_t conv_8_shift[64] = {
  -9, -8, -8, -8, -8, -9, -8, -7, -8, -8, -7, -8, -8, -8, -8, -7, -8, -7, -8, -7, 
  -8, -7, -9, -8, -7, -8, -7, -7, -7, -8, -7, -7, -7, -8, -7, -8, -8, -8, -8, -8, 
  -7, -8, -7, -8, -7, -6, -8, -7, -7, -7, -8, -8, -8, -8, -8, -8, -7, -7, -8, -9, 
  -8, -8, -8, -8
};

// Offsets and activation parameters.
static const int32_t conv_8_input_zero_point = -128;
static const int32_t conv_8_output_zero_point = -128;

// Weight and bias data.
alignas(16) static NS_PUT_IN_TCM int8_t conv_8_weights[] = {
  11, 13, -17, -21, 114, 17, 127, 4, -67, 37, -35, 5, 24, 14, -49, -79, -40, -55, 1, 2, 
  2, -10, -14, 1, -79, 33, -20, 15, -26, -70, 24, 26, 52, 24, -32, -21, -3, -48, -56, 127, 
  29, 68, 20, -43, 16, 109, -51, -46, -21, 12, -3, -14, -107, 124, -14, 82, -8, 7, -107, -103, 
  -77, 47, 29, 108, 80, 62, -34, 44, -52, -25, 97, 20, 7, 89, -82, 12, -18, 120, -50, -39, 
  -43, -60, 20, -57, -93, -35, 40, -41, 30, 103, -127, -11, -127, 27, -25, 22, -57, -22, -76, 49, 
  112, 81, 14, 70, 33, 76, 5, -79, -78, 5, 28, 22, 15, 43, -16, -19, -22, 26, -59, -51, 
  -69, 127, -33, -23, 38, -124, 9, -57, 25, 23, -16, -127, 37, -113, -31, 10, -68, -13, 11, -115, 
  -105, 4, 74, 124, -6, 63, 29, 72, -71, 99, 42, -22, 52, 27, 106, -12, -11, -59, 5, 26, 
  -19, -2, 67, -20, -32, -80, -56, 28, 56, 33, -7, -51, -6, -16, 28, 25, 10, 112, 27, -26, 
  -41, 56, -24, -52, 29, 34, 36, -127, -27, -4, -37, 57, 19, 10, -7, 13, -35, -87, 19, 0, 
  61, 31, 25, -47, 19, -101, 24, -73, 9, -27, -57, 34, 12, 127, 8, -22, 10, -96, 64, -117, 
  22, -24, 32, -24, -61, -92, 6, -4, 21, 20, 127, -8, 48, -17, -20, -3, -46, 23, 31, -60, 
  4, -8, -13, 26, 46, -18, 1, -15, -4, 15, 44, 10, 11, -30, 28, 46, 35, -42, 32, 50, 
  -16, -24, -22, -70, 108, 2, -76, 13, 20, -40, 8, -2, -23, 102, 102, -45, 78, -62, 80, 34, 
  15, 6, 18, -1, -52, 105, -127, -36, -19, -28, -25, 7, 29, 9, 30, -25, -100, -7, 93, 35, 
  -6, -55, -10, 10, -7, 31, -48, 61, -54, 21, -31, -22, 10, -57, 6, 28, -3, -44, 127, -9, 
  127, -30, 11, -16, 9, 5, -1, -5, -15, 23, -8, 31, 24, 18, 13, -42, 18, 19, 22, -9, 
  5, -2, -5, -27, -3, -33, -52, 0, -11, 19, 30, -4, 62, 44, -24, 42, -3, -30, 56, -28, 
  -118, 57, -67, 25, -15, -31, -5, -41, -47, -45, 7, -49, 53, -22, 37, 34, -42, -43, -127, 63, 
  26, 27, -84, -49, 85, 103, 115, -15, -81, 15, -23, 7, 34, -36, 0, -22, 75, 54, -107, -83, 
  1, -122, 127, -111, 30, 50, -79, 108, -62, 96, -112, 26, 9, -16, -63, 24, 100, -75, 0, 55, 
  55, -22, 8, -37, 127, 23, 7, -43, -5, 17, -61, -103, -79, 51, -51, -39, -14, 109, -22, -18, 
  -7, -28, 28, -98, -18, -9, 37, -32, -70, -3, 34, -36, -61, 40, 72, -72, 0, 62, -116, 49, 
  59, 19, 7, -63, -16, -50, 6, -21, 28, -77, -10, -16, 60, -101, 46, -42, -49, 127, 86, -54, 
  -18, -35, 75, -49, 47, 0, -2, 54, 8, -9, -63, 0, -84, 15, -20, -56, 6, 6, 0, -40, 
  36, -4, -66, 37, 2, -52, 12, -31, 47, 37, 127, -8, 21, 86, 18, 6, 50, 63, 14, 26, 
  -53, 30, -43, -50, 91, 85, -30, -3, 44, 25, -4, -65, -46, -17, 55, 27, -127, 34, 50, 103, 
  -38, -5, -43, -45, 58, -13, 21, 5, -22, 7, -27, -28, 7, 1, 8, 0, 20, 5, -11, -30, 
  38, 127, 6, -19, -24, -2, 17, 30, 34, 35, 4, 53, 33, 16, 3, -13, 12, 3, -8, -21, 
  53, 57, 27, -19, -53, 10, -42, 27, 127, -24, -31, 42, -3, 13, -40, 7, -4, 14, 123, 68, 
  -4, -45, 70, 44, -11, 1, 13, -49, 12, 13, -38, -50, 5, -6, -66, 78, 23, 66, 26, -94, 
  -36, 127, 28, -15, -7, 54, 5, 22, -53, 13, -46, 12, 60, 68, 8, -13, 92, 8, 13, 69, 
  -18, 28, 7, -27, 60, 15, 88, 56, 12, 26, -79, -30, 19, -23, -30, -36, 19, -41, -111, 21, 
  -25, -10, 30, -81, -114, 24, 46, 127, -44, 28, -18, -19, -49, 37, -1, -1, 47, 18, 0, 10, 
  49, 34, 24, 35, -23, -45, 48, 13, 57, -57, 55, 13, 42, 8, 15, -23, -19, 76, 66, -64, 
  -93, 124, -127, 75, 122, 3, 7, 49, 0, -30, 7, -117, 30, -29, -18, 14, 35, -127, -1, -73, 
  62, -53, -8, -17, 8, 17, 80, 30, 78, -82, -46, 38, -45, 74, -86, -12, 1, -36, -112, -51, 
  13, 20, -41, 1, -52, 0, 88, -86, -93, -8, 101, 48, -2, 46, -127, 11, -66, -27, -6, 79, 
  -61, -86, -68, -120, 93, -26, -5, 13, 39, 30, -24, -41, -61, 11, 40, -33, -33, 22, -20, -21, 
  29, -24, 10, -40, 8, 32, -127, 30, 31, -59, 108, -41, 29, -68, 48, -35, -1, -24, -35, 38, 
  35, -18, -31, 80, 34, 55, -42, 65, -37, 52, -27, 59, -4, -6, 4, 7, 48, -38, -70, 30, 
  -39, -69, -88, -43, -40, 58, -16, 14, -95, 127, 17, -26, 23, -70, -42, -15, -31, -74, 127, 46, 
  29, 104, 46, -57, -29, 15, 47, -87, 19, -11, 15, 42, 7, 38, -85, -75, -36, 17, 30, -29, 
  37, -121, -41, 29, 109, 34, 11, -40, -50, -37, 20, 34, 36, 19, -36, 17, -11, -7, 32, -127, 
  11, 24, 37, 14, 5, -27, 22, -39, -4, -12, -23, -13, -11, 13, -30, -3, 67, -13, -8, 7, 
  104, -28, -108, 7, -53, 112, -89, 20, -53, -85, 9, -127, 32, -27, -23, -33, -66, -91, -12, -65, 
  -7, -52, 6, 83, 22, 70, 20, 21, 19, -53, -29, -10, 31, -72, 14, 1, 68, 41, -29, -20, 
  3, 5, -38, -53, -82, -6, -5, -4, 32, 6, 12, -68, 127, 29, 22, -28, 30, -41, 84, 83, 
  -63, 62, 34, -11, 11, 2, -13, -14, 28, -23, -61, -9, 36, 103, -44, -37, -7, -77, -31, 11, 
  -30, 0, -3, 54, 0, -7, 3, 18, -40, 127, 48, -38, 44, -4, -23, -10, -70, -58, -13, 74, 
  -44, 24, -48, -58, -91, 18, -76, -41, -75, -14, 65, -1, -109, 95, -2, -75, -30, -109, -109, 62, 
  127, 27, 71, -50, 14, -22, 6, 16, 75, 64, 2, 19, -74, 35, 12, 39, 103, 10, -32, -16, 
  -27, -30, 51, -37, 1, 0, 24, -18, 56, 94, 19, 117, 127, 29, -76, 52, 48, -6, -42, -4, 
  -127, -60, 84, -5, 30, -87, -18, 38, -97, -71, 12, 41, -44, -16, 100, -6, 32, 28, -36, -21, 
  -3, -90, -73, 100, -28, -3, -58, -68, 17, 48, 45, 34, 26, 13, -7, -50, 22, -25, 1, 53, 
  65, 26, 65, -38, 108, 1, 5, -33, -9, -28, 44, 56, -9, -29, 34, 76, -48, 127, -16, -29, 
  -24, 59, 35, 3, 2, 36, 35, -45, 57, -40, 9, 54, 12, -104, -3, 31, 87, 26, 45, 20, 
  -51, 3, -3, 56, 4, -63, -127, 29, -63, 6, -28, -104, 127, -15, -10, -52, -11, 43, 85, 14, 
  14, 6, -25, -19, -35, -1, 19, -38, -56, -26, -45, -2, 14, 31, -23, -13, -16, 23, -44, -3, 
  -53, 32, 27, -3, -51, 90, 35, -44, -88, -91, -127, 52, 85, -75, 13, -46, 22, 17, -21, 0, 
  123, -5, 57, -75, -50, 30, 6, 50, 38, -54, -4, -92, 39, -5, -71, 26, 7, -104, 0, 43, 
  -19, 18, -66, -46, -30, -14, -105, -5, -48, -20, 7, 8, -46, 110, -58, -3, -76, -18, 5, 18, 
  17, 43, 4, -2, -48, -22, 23, -127, -36, 8, 39, -6, 16, -27, 6, 3, -120, 4, -12, 43, 
  -30, -77, 21, 50, -20, -18, 54, 89, -14, 61, -27, 4, 53, -127, -22, 33, 78, -20, -6, -6, 
  -41, 62, 2, -37, 11, -14, 55, -5, -6, 75, 2, -22, 18, -7, 38, 16, 16, -127, 24, 5, 
  -3, 30, 13, 8, -12, 5, 31, -52, -29, -29, -60, 33, -41, 4, 124, 11, -50, 3, 39, 22, 
  23, 49, -7, 29, -28, 1, -12, 0, 8, -6, -33, 15, 16, -127, -54, 34, 34, 50, -30, -43, 
  27, 1, 108, 39, 23, -45, 18, 55, -25, 15, -27, -88, -5, -21, -68, 21, 127, 10, -10, -4, 
  -15, 3, -16, -3, 16, -6, 34, -42, 27, -39, 36, -15, 27, -50, 8, 2, 29, 8, 17, -28, 
  -26, 127, 51, -1, -41, 25, -22, -10, -8, 21, 12, 19, 73, -40, -7, 64, -21, 28, -9, 50, 
  -26, -95, -34, -64, -41, 49, -29, -29, -50, -18, 13, 29, -45, -18, -19, -39, -36, -58, 70, 89, 
  58, 17, -24, 20, 57, -28, 30, 78, -116, -89, -15, -8, 127, -59, -29, 72, -24, -57, 127, 101, 
  28, 69, -63, 22, -17, 32, -11, -12, -48, -19, 35, 127, 78, -20, -24, -17, 45, -61, -54, 8, 
  15, 25, 39, 2, -26, -62, -45, -29, 8, -32, 1, -9, -63, 61, -45, 11, -42, -14, 8, 36, 
  -3, 54, 0, -1, 11, -53, 13, -9, 76, -4, -43, -19, -9, -23, -14, 45, -93, 17, -33, 127, 
  -36, 28, -61, -111, 85, -20, -15, 27, -37, -127, -28, -56, -63, 13, -58, 58, 21, 124, -81, 37, 
  -87, -83, 23, 12, 24, -19, 16, 2, -96, 5, -95, -37, -73, 41, 72, 58, 27, -1, -58, -32, 
  57, -41, 127, -43, -45, -23, 17, 62, 15, 23, -47, -27, 18, -17, 33, 14, 16, 3, 45, -9, 
  -1, -8, -26, 118, 53, 3, -12, 5, 127, -10, 29, 9, -81, 69, 83, -26, 10, 73, -17, -34, 
  -13, 1, 21, -84, -7, -12, -13, -22, 24, -53, 27, 12, 1, -27, -37, -55, 1, -18, 7, -11, 
  127, -24, -10, 23, 6, 1, 33, -28, 12, 107, -65, -35, 10, -60, 63, -95, -21, -42, -84, -2, 
  18, 4, 75, -46, -12, -83, -49, -30, 13, 101, 16, 2, 4, -3, 12, 99, 70, 86, -61, 37, 
  -36, -18, 36, 37, 111, 95, -92, -59, 109, 4, 19, 7, -1, -17, 36, 35, -4, -81, 127, -60, 
  56, -69, 7, -8, 85, -63, -17, 53, 50, 127, 49, -1, 44, 18, -16, -17, -56, 13, 29, -118, 
  -14, -5, 40, -76, -98, -28, 19, 40, 65, -31, -122, -30, -45, 37, -32, -37, -6, -60, 101, 51, 
  -59, -48, 107, -127, 1, 26, -12, 20, 33, 17, -113, -58, -69, -68, 19, 112, 110, 27, 24, -35, 
  -49, -25, -1, 4, -41, -100, -49, -59, 55, -125, 94, -9, -5, -100, -58, -75, 10, -82, -5, -44, 
  92, 33, -3, 72, 56, 127, 81, -22, -56, 18, -92, -15, -2, -42, 113, -111, -4, -20, -51, 69, 
  34, 45, -5, -10, -2, -21, -24, -122, 43, -82, 44, -20, 5, -109, 25, -47, -73, -27, -82, 13, 
  10, 47, 47, 7, 10, -127, 32, -111, -1, 1, -18, -26, 17, -14, -94, 69, 32, -15, -66, -53, 
  24, 117, -26, -15, 69, -18, -19, -28, -126, -94, 51, -76, -32, 23, 57, -20, -67, -3, 18, -78, 
  -51, 64, -116, 127, -19, 17, 7, -10, 26, -51, -7, -28, -68, -32, -15, 59, -55, -89, 30, -71, 
  -86, -14, 17, -80, 47, -43, -34, 22, 11, 22, -15, 127, -12, 7, -39, 22, 20, -127, -120, -74, 
  -3, 109, 105, 29, 58, -9, -54, 20, -78, -21, -4, -1, -34, -14, -103, -25, -108, -52, 66, -90, 
  4, 25, 50, 74, -25, 42, 44, 46, -13, -69, -26, 52, -40, -2, 81, -90, -3, -3, -83, 48, 
  -115, -27, -14, -74, -101, -81, -41, -5, 72, -23, -45, -127, -15, 66, -35, 59, -34, 49, 51, -43, 
  -24, -2, -38, -39, -84, -48, -127, 68, -14, -30, 64, -53, -93, 62, 2, -12, 54, 95, -16, -75, 
  -25, 35, -81, 11, 102, -8, 88, -33, 24, 11, 38, 56, 28, -16, -3, -15, -70, -80, 47, 12, 
  -3, -9, 63, 28, 38, 16, -127, 31, -87, -39, -4, -34, 25, -30, 10, 96, 52, 20, -30, 4, 
  -36, 0, -26, 18, -9, -35, 56, -57, 28, -1, 3, -72, -23, 35, 48, -18, 55, 87, -5, 61, 
  -20, -41, 36, 2, 20, -124, 20, 46, 64, 92, -127, 40, 39, 21, -1, -22, -15, 71, 59, -17, 
  20, 2, -77, 3, -11, -38, 51, 6, 73, -38, -16, -62, 53, 35, -33, -20, 10, -40, -5, 49, 
  -8, -127, -54, 51, 22, 64, 116, -14
};

#if HAS_BIAS
alignas(16) static NS_PUT_IN_TCM int32_t conv_8_bias[] = {
  15956, 975, 9376, -144, -11245, 6122, 12378, -2234, 2141, 9436, 1510, 11065, 8290, 13436, 10620, 570, -6686, -10103, -2453, -13392, 
  4228, -4673, 17029, 17946, 6977, 2014, 2116, 4818, 10045, 2746, -895, 12392, -13918, 14911, -11728, 14470, 6843, 6772, 18653, 8138, 
  4268, 2888, 4412, 5934, -3099, 5267, 9423, 13912, -2986, 5640, 8784, -5368, 11416, 11088, -6580, 20470, 13620, 7383, 3244, 27452, 
  -1336, 7875, -3676, -288
};
#else
static NS_PUT_IN_TCM int32_t *conv_8_bias = NULL;
#endif


alignas(16) static NS_PUT_IN_TCM int8_t conv_8_scratch_buffer[SCRATCH_BUFFER_SIZE];

static cmsis_nn_context conv_8_context = {
    .buf = conv_8_scratch_buffer,
    .size = sizeof(conv_8_scratch_buffer),
};

const cmsis_nn_per_channel_quant_params conv_8_quant_params = {
    .multiplier = (int32_t*)conv_8_multiplier,
    .shift = (int32_t*)conv_8_shift,
};


const cmsis_nn_conv_params conv_8_conv_params = {
    .input_offset = -conv_8_input_zero_point,
    .output_offset = conv_8_output_zero_point,
    .stride.w = 1,
    .stride.h = 1,
    .padding.w = 0,
    .padding.h = 0,
    .dilation.w = 1,
    .dilation.h = 1,
    .activation.min = -128,
    .activation.max = 127,
};

int32_t aot_conv_8_init(void)
{
    return 0;
}

int32_t aot_conv_8_run(const int8_t* __restrict input, int8_t* __restrict output)
{

    return arm_convolve_wrapper_s8(
        &conv_8_context,
        &conv_8_conv_params,
        &conv_8_quant_params,
        &conv_8_input_dims,
        input,
        &conv_8_filter_dims,
        conv_8_weights,
        &conv_8_bias_dims,
        conv_8_bias,
        &conv_8_output_dims,
        output
    );

}
