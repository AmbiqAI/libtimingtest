# aot-unit-test AOT Inference Module

> ğŸ”§ **Generated by HeliosAOT** on 2025-06-10

## âš¡ï¸ Overview

This folder contains an ahead-of-time (AOT) compiled C inference module for **aot-unit-test**, targeting **neuralspot**.
It implements your LiteRT model **kws_ref_model.tflite**.

- [Model Contents](#module-contents)
- [Model Summary](#model-summary)
- [Configuration](#configuration)
- [Integration / Build](#integration--build)
- [Usage Example](#usage-example)
- [License](#license)
- [Model Diagram](#model-diagram)

## ğŸ“¦ Module Contents

```console
aot-unit-test
â”œâ”€â”€ LICENSE.txt â† license for this module
â”œâ”€â”€ README.md â† this file
â”œâ”€â”€ includes-api/ â† API header files
â”œâ”€â”€ src/ â† C source files
â”œâ”€â”€ zephyr/ â† For Zephyr integration
â”œâ”€â”€ module.mk â† For neuralSPOT integration
â””â”€â”€ CMakeLists.txt â† For Zephyr integration
```

## ğŸ§  Model Summary

| Property               | Value                         |
|------------------------|-------------------------------|
| **Model name**         | kws_ref_model.tflite                 |
| **Model Version**      | v1.0.0              |
| **Subgraph Index**     | 0                   |
| **Operator Count**     | 12            |
| **Unique Ops**         | 5           |
| **Input Shape**        | (  1, 49, 10, 1)        |
| **Output Shape**       | (  1, 12)       |

## âš™ï¸ Operators Used

| Operator           | Count |
|--------------------|-------|
| `CONV_2D` | 5 |
| `DEPTHWISE_CONV_2D` | 4 |
| `AVERAGE_POOL_2D` | 1 |
| `FULLY_CONNECTED` | 1 |
| `SOFTMAX` | 1 |

## ğŸ›ï¸ Configuration Parameters

```yaml
model_path: models/kws_ref_model.tflite
output_path: /Users/adampage/Ambiq/neuralspot/ns-aot-unit-test/modules
module_name: aot-unit-test
module_type: neuralspot
prefix: aot
memory_planner: greedy
operator_attributes: []
transforms:
  transforms:
    PruneReshapeOps: true
    PruneSqueezeOps: true
include_test: true
test_tolerance: 1.0
subgraph: 0
model_version: v1.0.0
verbose: 2
log_file: null

```

## ğŸ› ï¸ Integration / Build

### Zephyr RTOS

1. Copy this module into your Zephyr project under modules/lib/aot-unit-test.

2. Add to your west.yml:

    ```yaml

    projects:
    - name: aot-unit-test
        path: modules/lib/aot-unit-test
        revision: main   # or pin a tag/commit
    ```

3. In your applicationâ€™s CMakeLists.txt:

    ```cmake
    find_package(aot-unit-test REQUIRED)
    target_link_libraries(app PRIVATE aot-unit-test::aot-unit-test)
    ```

4. Build with:

    ```bash
    west build -b <board> samples/your_app
    ```

### neuralSPOT

ğŸš§ Coming soon...

## ğŸš€ Usage Example

```c

#include "aot_model.h"

// Define input/output buffer
int8_t input[aot_input_len] = { 0 };
int8_t output[aot_output_len];

// Define model context and callback
static void aot_model_operator_cb(
    int32_t op,
    aot_operator_state_e state,
    int32_t status,
    void *user_data
) {
    switch (state) {
        case aot_model_state_started:
            ns_lp_printf("Operation %d started\n", op);
            break;
        case aot_model_state_finished:
            ns_lp_printf("Operation %d finished with status %d\n", op, status);
            break;
    }
}


// This is optional, but useful for profiling or debugging
aot_model_context_t aot_model_ctx = {
    .callback = aot_model_operator_cb,
    .user_data = NULL
};

int main(void) {
    // Initialize model
    int32_t status;
    status = aot_model_init(&aot_model_ctx);

    // Run inference
    status = aot_model_run(&aot_model_ctx, input, output);

    return 0;
}

```

## License

This code is licensed under the terms in [LICENSE.txt](./LICENSE.txt).
Use of this generated module is restricted to Ambiq hardware only.

---

## Model Diagram

```mermaid
---
config:
  look: handDrawn
  theme: neutral
---
flowchart TB
  op0["0: conv_0"]
  op1["1: depthwise_conv_1"]
  op2["2: conv_2"]
  op3["3: depthwise_conv_3"]
  op4["4: conv_4"]
  op5["5: depthwise_conv_5"]
  op6["6: conv_6"]
  op7["7: depthwise_conv_7"]
  op8["8: conv_8"]
  op9["9: average_pool_9"]
  op11["11: fully_connected_11"]
  op12["12: softmax_12"]
  op0 -->|"T23"| op1
  op1 -->|"T24"| op2
  op2 -->|"T25"| op3
  op3 -->|"T26"| op4
  op4 -->|"T27"| op5
  op5 -->|"T28"| op6
  op6 -->|"T29"| op7
  op7 -->|"T30"| op8
  op8 -->|"T31"| op9
  op9 -->|"T32"| op11
  op11 -->|"T34"| op12
```
